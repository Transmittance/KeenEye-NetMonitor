<!doctype html>
<html>
<head>
    <title>{{ name }}</title>
    <style>
        table { border-collapse: collapse; font-family: monospace; }
        th, td { border: 1px solid #ccc; padding: 4px 6px; }
        th { background: #eee; }
    </style>
</head>
<body>

<h2>Flows: {{ name }}</h2>
<p>Total flows: {{ flows|length }}</p>

<table>
    <tr>
        <th>src</th>
        <th>dst</th>
        <th>sport</th>
        <th>dport</th>
        <th>proto</th>
        <th>packets</th>
        <th>bytes</th>
        <th>duration</th>
        <th>pps</th>
        <th>bps</th>
        <th>ext_ip</th>
        <th>domain</th>
        <th>TCP SYN</th>
        <th>TCP RST</th>
        <th>TCP ACK</th>
        <th>TCP FIN</th>
    </tr>

    {% for f in flows %}
    <tr>
        <td>{{ f.src }}</td>
        <td>{{ f.dst }}</td>
        <td>{{ f.sport }}</td>
        <td>{{ f.dport }}</td>
        <td>{{ f.proto }}</td>
        <td>{{ f.packets }}</td>
        <td>{{ f.bytes }}</td>
        <td>{{ "%.3f"|format(f.duration) }}</td>
        <td>{{ "%.2f"|format(f.pps) }}</td>
        <td>{{ "%.1f"|format(f.bps) }}</td>
        <td>{{ f.ext_ip or "" }}</td>
        <td>{{ f.domain or "" }}</td>
        <td>{{ f.tcp_syn }}</td>
        <td>{{ f.tcp_rst }}</td>
        <td>{{ f.tcp_ack }}</td>
        <td>{{ f.tcp_fin }}</td>
    </tr>
    {% endfor %}
</table>

</body>
</html>
